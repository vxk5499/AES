#include <stdio.h>

void multiplication(unsigned int a_2d[4][4], unsigned int b_2d[4][4]);
void encrypt(unsigned int PlainText[4][4], unsigned int Key[4][4], unsigned int CipherText[4][4]);
void gcm(unsigned int p1[4][4], unsigned int p2[4][4], unsigned int p3[4][4],unsigned int p4[4][4],
		unsigned int a1[4], unsigned int a2[4],	unsigned int iv[4][4],unsigned int key[4][4]);
void AES_printf (unsigned int AES_StateArray[][4]);

int main(void) {
	//3 rd test case

	unsigned int a1[4]  = { 0x00, 0x00, 0x00, 0x00 };
	unsigned int a2[4]  = { 0x00, 0x0, 0x0, 0x0 };
	unsigned int p1[4][4] = {{0xd9, 0xf8, 0xa5, 0xaf},
						{0x31, 0x84, 0x59, 0xf5},
						{0x32, 0x06, 0x09, 0x26},
						{0x25, 0xe5, 0xc5, 0x9a}};
	unsigned int p2[4][4]  = {{0x86, 0x15, 0x2e, 0x8a},
						{0xa7, 0x34, 0x4c, 0x31},
						{0xa9, 0xf7, 0x30, 0x8a},
						{0x53, 0xda, 0x3d, 0x72}};
	unsigned int p3[4][4]  = {{0x1c, 0x95, 0x2f, 0x49},
						{0x3c, 0x68, 0xcf, 0xa6},
						{0x0c, 0x09, 0x0e, 0xb5},
						{0x95, 0x53, 0x24, 0x25}};
	unsigned int p4[4][4]  = {{0xb1, 0xaa, 0xba, 0x1a},
						{0x6a, 0x0d, 0x63, 0xaf},
						{0xed, 0xe6, 0x7b, 0xd2},
						{0xf5, 0x57, 0x39, 0x55}};


	//4 th test case
/*
	unsigned int a1[4]  = {0xfeedface, 0xdeadbeef, 0xfeedface, 0xdeadbeef};
	unsigned int a2[4]  = {0xabaddad2, 0x0, 0x0, 0x0};

	unsigned int p1[4][4] = {{0xd9, 0xf8, 0xa5, 0xaf},
					{0x31, 0x84, 0x59, 0xf5},
					{0x32, 0x06, 0x09, 0x26},
					{0x25, 0xe5, 0xc5, 0x9a}};
	unsigned int p2[4][4]  = {{0x86, 0x15, 0x2e, 0x8a},
					{0xa7, 0x34, 0x4c, 0x31},
					{0xa9, 0xf7, 0x30, 0x8a},
					{0x53, 0xda, 0x3d, 0x72}};
	unsigned int p3[4][4]  = {{0x1c, 0x95, 0x2f, 0x49},
					{0x3c, 0x68, 0xcf, 0xa6},
					{0x0c, 0x09, 0x0e, 0xb5},
					{0x95, 0x53, 0x24, 0x25}};
	unsigned int p4[4][4]  = {  {0xb1, 0xaa, 0xba, 0x0},
					{0x6a, 0x0d, 0x63, 0x0},
					{0xed, 0xe6, 0x7b, 0x0},
					{0xf5, 0x57, 0x39, 0x0} };*/
	unsigned int iv[4][4] =  {{0xca, 0xfa, 0xde, 0x00},
					{0xfe, 0xce, 0xca, 0x00},
					{0xba, 0xdb, 0xf8, 0x00},
					{0xbe, 0xad, 0x88, 0x00}};
	unsigned int key[4][4] = {  {0xfe,  0x86,  0x6d,  0x67},
					{0xff, 0x65,  0x6a,  0x30},
					{0xe9, 0x73,  0x8f,  0x83},
					{0x92, 0x1c,  0x94,  0x08}};

	gcm(p1, p2, p3, p4,	a1, a2,iv,key);

	return 0;
}

void AES_printf (unsigned int AES_StateArray[][4])
{
    int i;
    printf("   W0  W1  W2  W3\n\n");
    for(i=0; i<4; i++)
        printf("   %02x  %02x  %02x  %02x\n",
                AES_StateArray[i][0], AES_StateArray[i][1],
                AES_StateArray[i][2], AES_StateArray[i][3]);
    printf("\n");
}
